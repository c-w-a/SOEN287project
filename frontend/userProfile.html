<!DOCTYPE html>
<html lang = "en">
<head>
    <title> My Profile </title>
    <meta charset = "utf-8"/>
    <link rel="stylesheet" href="styles.css">

</head>
<body class = "profilestyle">
  <a href = "index.html">
     Go back
  </a>
    <h1> My Profile</h1>
  <div class = "profilestyle">
    <img src = "https://cdn1.iconfinder.com/data/icons/heroicons-solid/20/user-circle-1024.png"
          alt = "user" width = "55" height = "55" />
    <h2><span id="userName"></span></h2>
    <hr>
      
  <h3>User Details</h3>
  <p><strong>Email:</strong> <span id="userEmail"></span></p>
  <p><strong>Phone:</strong> <span id="userPhone"></span></p>
  <p><strong>Address:</strong> <span id="userAddress"></span></p>
  <button onclick="editProfile()">Edit Profile</button>
  <button onclick="deleteAccount()">Delete Account</button>
</div>

<div class = "profilestyle">
  <h3>Manage</h3>
 <button onclick = "location.href = 'userServices.html'">My Services</button>
  <br>
  <button onclick = "location.href = 'userReceipts.html'">My Payments</button>
  <br>
  <button onclick = "logoutUser()">Logout</button>

</div>

  <script>

    const email = localStorage.getItem('loggedIn');
    const userArr = JSON.parse(localStorage.getItem('userArr'));
            if (userArr === null) 
            {
                userArr = [];
            }
    const thisUser = userArr.find(user => user.email === email);

    document.getElementById('userEmail').textContent = email;
    document.getElementById('userName').textContent = thisUser.name;
    document.getElementById('userAddress').textContent = thisUser.address;
    document.getElementById('userPhone').textContent = thisUser.phone;
    document.getElementById('userPassword').textContent = thisUser.password;

    function editProfile() {
            const newName = prompt("Enter new name", thisUser.name);
            const newAddress = prompt("Enter new address", thisUser.address);
            const newPhone = prompt("Enter new phone number", thisUser.phone);
            
            if (newName && newAddress && newPhone) {
                thisUser.name = newName;
                thisUser.address = newAddress;
                thisUser.phone = newPhone;
                localStorage.setItem('userArr', JSON.stringify(userArr));
                location.reload();
            }
        }

        function deleteAccount() 
        {
            if (confirm("Are you sure you want to delete your account? This action cannot be undone.")) {
                const updatedUserArr = userArr.filter(user => user.email !== email);
                localStorage.setItem('userArr', JSON.stringify(updatedUserArr));
                localStorage.removeItem('loggedIn');
                window.location.href = 'index.html';
            }
        }


    function logoutUser()
    {
      localStorage.removeItem('loggedIn');
      window.location.href = 'index.html'
    }

  </script>

</body>
